{
  "versions": [
    {
      "version": "4.0.1",
      "version_code": 128,
      "release_date": "2026-02-17",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29059428,
      "sha256": "e8980a91f1b4e103bd2f1c088d5cf3284531b251c2f5d7496328412e4e1867a5",
      "changes": [
        "FIX: Убран диалог установки — полностью тихая OTA установка",
        "FIX: Stream install через cat | pm install -S SIZE",
        "FIX: Установка через /data/local/tmp с повышенными привилегиями",
        "FIX: Флаги --user 0, --bypass-low-target-sdk-block",
        "FIX: Fallback reinstall: uninstall + install (сброс signature)"
      ],
      "required": true
    },
    {
      "version": "4.0.0",
      "version_code": 127,
      "release_date": "2026-02-17",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29059424,
      "sha256": "2b2d5d18888ede778b7816ba8374e254fa8e53536eeedd0b6ea5c9ece65cb413",
      "changes": [
        "ENTERPRISE: ScriptScheduler — HOURLY/DAILY/INTERVAL/CRON/POINTS расписания",
        "ENTERPRISE: PIXEL_CHECK/WAIT/GROUP — проверка цвета пикселей через screencap",
        "ENTERPRISE: WAIT_SCREEN_STABLE — ожидание стабильности экрана через md5 hash",
        "ENTERPRISE: SUBSCRIBE_EVENT — подписка на события с jump to handler step",
        "ENTERPRISE: AdaptiveCpuThrottler — мониторинг CPU через /proc/stat"
      ],
      "required": true
    },
    {
      "version": "3.16.0",
      "version_code": 126,
      "release_date": "2026-02-17",
      "download_url": "https://adb.leetpc.com/downloads/SphereAgent-v3.16.0.apk",
      "size_bytes": 36311351,
      "sha256": "",
      "changes": [
        "ENTERPRISE: VPN Diagnostics — расширенная диагностика (трафик, latency, DNS, kill-switch)",
        "ENTERPRISE: Smart Rotation v2 — least-used tunnel selection",
        "ENTERPRISE: Circuit Breaker v2 — 3-state fault tolerance",
        "ENTERPRISE: Frontend VPN Dashboard v3 — Events, IP Check, Infrastructure табы",
        "FIX: deprecated MediaType.parse → toMediaTypeOrNull"
      ],
      "required": true
    },
    {
      "version": "3.13.6",
      "version_code": 123,
      "release_date": "2026-02-16",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "",
      "changes": [
        "FIX: Универсальный запуск scrcpy-server: sh → su fallback",
        "FIX: Подключение к сокету через ABSTRACT и FILESYSTEM namespace",
        "FIX: Раннее завершение при смерти процесса scrcpy-server",
        "FIX: Увеличен таймаут подключения к сокету до 15с",
        "FIX: Асинхронное логирование stderr scrcpy-server",
        "FIX: Сброс флага isCurrentlyStreaming при фатальной ошибке",
        "FIX: Backend binary protocol auto-detect с fallback на raw frame"
      ],
      "required": true
    },
    {
      "version": "3.13.5",
      "version_code": 122,
      "release_date": "2026-02-15",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "",
      "changes": [
        "FIX: Запуск scrcpy-server через sh -c вместо su -c",
        "FIX: scrcpy-server не требует root прав"
      ],
      "required": true
    },
    {
      "version": "3.13.4",
      "version_code": 121,
      "release_date": "2026-02-15",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "",
      "changes": [
        "FIX: Убраны video_codec_options для совместимости с LDPlayer",
        "FIX: Увеличен таймаут подключения к сокету до 10с",
        "FIX: Добавлено логирование stderr scrcpy-server"
      ],
      "required": true
    },
    {
      "version": "3.13.3",
      "version_code": 120,
      "release_date": "2026-02-15",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "",
      "changes": [
        "FIX: Исправлен чёрный экран стрима — формат video_codec_options",
        "FIX: i-frame-interval:int=2 — корректный формат для scrcpy-server 2.4"
      ],
      "required": true
    },
    {
      "version": "3.13.2",
      "version_code": 119,
      "release_date": "2026-02-15",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "",
      "changes": [
        "FIX: Исправлен чёрный экран стрима — scrcpy socket не создавался",
        "FIX: tunnel_forward=false — scrcpy-server теперь слушает на сокете"
      ],
      "required": true
    },
    {
      "version": "3.13.1",
      "version_code": 118,
      "release_date": "2026-02-15",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "",
      "changes": [
        "FIX: Исправлен чёрный экран стрима — scrcpy-server падал с NumberFormatException",
        "FIX: Уменьшен диапазон scid с Int.MAX_VALUE до 1-100000 для совместимости с scrcpy-server 2.4"
      ],
      "required": true
    },
    {
      "version": "3.13.0",
      "version_code": 117,
      "release_date": "2026-02-13",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 29026656,
      "sha256": "7b71ef8df72f8b7655fb337f3d66732201cef654dfd85b8bef0d9b8092b4c1a6",
      "changes": [
        "ENTERPRISE: VPN auto-restore при перезапуске агента (конфиг в SharedPreferences)",
        "ENTERPRISE: Адаптивные таймауты handshake (20с/40с/60с)",
        "ENTERPRISE: VpnHealthMonitor v2.0 — 10 попыток auto-recover, exponential backoff",
        "ENTERPRISE: Полная синхронизация vpnActive во всех путях",
        "ENTERPRISE: Сброс счётчика auto-recover после 30мин стабильной работы"
      ],
      "required": true
    },
    {
      "version": "3.12.0",
      "version_code": 116,
      "release_date": "2026-02-13",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 36294967,
      "sha256": "1b4fe05b14ab654c7d1e5cbfd8ecb3cba0d954c258dd91e99bedd208b599286b",
      "changes": [
        "FIX: connectionManager.vpnActive обновляется после vpn_config, vpn_activate, vpn_deactivate",
        "FIX: vpnExternalIp и vpnConfigType синхронизируются с VpnManager в heartbeat",
        "FIX: Backend корректно отображает vpn_active=true для агентов с активным VPN"
      ],
      "required": true
    },
    {
      "version": "3.6.2",
      "version_code": 102,
      "release_date": "2025-02-08",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 16507743,
      "sha256": "1d48628ba01566fb1f506d1e17bbe6ec4e2c851fb5fc497679929ce04ef33840",
      "changes": [
        "FIX: OkHttpClient shutdown on destroy — prevents thread pool/connection pool leak",
        "FIX: Circuit-breaking after 500 reconnect attempts — 60s pause then reset",
        "FIX: disconnect() cancels ALL child jobs (heartbeat, watchdog, reconnect) — fixes zombie coroutines",
        "FIX: bufferMessage() @Synchronized — fixes TOCTOU race on offlineBuffer",
        "FIX: statusBatchBuffer capped at 200 entries — prevents OOM during long disconnects",
        "FIX: onDestroy() calls connectionManager.shutdown() instead of disconnect()"
      ],
      "required": true
    },
    {
      "version": "3.6.1",
      "version_code": 101,
      "release_date": "2025-02-07",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 0,
      "sha256": "",
      "changes": [
        "CRITICAL: Устранение ANR на 14+ LDPlayer эмуляторах",
        "FIX: BootReceiver — AtomicBoolean guard, 0 Thread.sleep, 0 su процессов",
        "FIX: RootAutoStart/RootInitInstaller — батч su (1 процесс вместо 30+)",
        "FIX: SphereAgentApp — ROOT ops отложены на 60с, одноразовый флаг",
        "FIX: AgentService — удалены restart alarm (START_STICKY + WorkManager)",
        "FIX: CommandExecutor — все process streams закрываются через use{}",
        "FIX: H264RootStreamService — NAL буфер с лимитом 2MB (защита от OOM)",
        "FIX: ConnectionManager — AtomicInteger для pendingFrames, атомарный drain offlineBuffer",
        "FIX: ServerDiscovery — Semaphore(24) вместо 254 параллельных async",
        "FIX: ScreenCaptureService — удалён дубликат UpdateManager",
        "FIX: ScriptLogSender — ConcurrentHashMap вместо mutableMapOf",
        "FIX: BootContentProvider — coroutine delay вместо Thread.sleep",
        "PERF: init.rc — 1 триггер вместо 4"
      ],
      "required": true
    },
    {
      "version": "3.5.9",
      "version_code": 99,
      "release_date": "2025-02-04",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 16507743,
      "sha256": "",
      "changes": [
        "FIX: JSON serialization for script_log_batch",
        "Script logs now correctly sent to backend",
        "Improved logging and debugging"
      ],
      "required": true
    },
    {
      "version": "3.5.8",
      "version_code": 98,
      "release_date": "2025-02-04",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 16507583,
      "sha256": "",
      "changes": [
        "CRITICAL: IP fallback on DNS resolution failure",
        "Auto-switch to next server when DNS/connection error",
        "Hardcoded production IP in APK (212.220.204.72)",
        "Improved fault tolerance for emulator fleets"
      ],
      "required": true
    },
    {
      "version": "3.5.7",
      "version_code": 97,
      "release_date": "2025-01-23",
      "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk",
      "size_bytes": 0,
      "sha256": "",
      "changes": [
        "Multi-CDN config sources",
        "Emergency command execution",
        "HTTP polling fallback"
      ],
      "required": false
    }
  ],
  "latest": {
    "version": "4.0.1",
    "version_code": 128,
    "download_url": "https://adb.leetpc.com/api/v1/agent/updates/latest.apk"
  }
}
